my immediate todo:

review firewall rules

TODO FOR SEMIS:
TCP-VIEW SYSINTERNALS, SIGCHECK, ACCESSENUM, REGSCANNER
ensure netsh stuff is there and netsh reset
hosts file...
get secure adapter/port settings
make sure important windows settings are covered
elaborate on winchecklist and create timestamps for everything
come back to this for registry baseline : https://www.youtube.com/watch?v=7W_3wnjvj5c
analyze the sysinternals autoruns, netstat/backdoor stuff from tirefire and john, procmon/hacker, look at network scanning tools like wireshark. also about accessENUM
script windows defender manually because LGPO can't do it
review nirsoft tools and keep working on checklist from security tips
how to secure the network settings
learn about SAM (security account manager)
  also into stuff like hidden users and weird stuff
test scripts again
look into nessus tool??
registry baseline
  examining configured GPOs on the challenge image or comparing default Windows folder permissions with those harvested during competition.
make list of services that must be up and running before script
retry heist image -> check if dlls actually broken. try actually doing in order so fixing malware stuff before script and try fixing firewall with psexec. in startup registry key find out what the actual exec was.
configure service on/off tool. remember what you learned about ftp
go into depth about net firewalls?
  possbily blocking port 21 for ftp if not allowed or smth like that
  secure various ports. learn how to use netstat -ano or other netstat tools to find network backdoors or bad ports)
learn how the windows file system actually works
make the appsec file and start adding stuff to it. first find out all crit services from old messages in the server. 
  appsec is also app auto updates and app permissions ontop of secure settings
  find out how to develop a method that would consistently flag all manually installed packages on the system.
apply the other registry changes
GO THROUGH A CHECKLIST OF CORE WINDOWS UTILITIES THAT MUST BE UP/WORKING BEFORE STARTING ANYTHING AFTER FORENSICS QUESTIONS
get config files for appsec for common critical applications
LOOK THROUGH SERVICES AGAIN
(IMPORTANT) figure out core issues with system after forensics. you should understand the general problems and make a plan of attack before even beginning scripts
PRACTICE WITH THE EVENT VIEWER / ID LIST TO FIND IMPORTANT CHANGES
look at insecure drivers
look at insecure DLLs



MISSING FROM APERTURE:
24, 28, 29, 30, 31, 33, 34, 35, 36, 52, 53, 61(get from searchthrough script), 62(get from script), 63, 64, 65, 66-73, 83-91
GO THROUGH EVERYTHING WITH CHAT GPT
CHAT GPT'd/REMEDIATED ONES:
24(cis), 

IMAGE ATTEMPT ORDER : ZOO, KALIPATRIOT HEIST, APERTURE, BALDIS BASICS, MAYBE KAC?


FOR WINDOWS AUTOMATIC UPDATES:
    reg add HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU /v AutoInstallMinorUpdates /t REG_DWORD /d 1 /f
    reg add HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU /v NoAutoUpdate /t REG_DWORD /d 0 /f
    reg add HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU /v AUOptions /t REG_DWORD /d 4 /f
    reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update" /v AUOptions /t REG_DWORD /d 4 /f
    reg add HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate /v DisableWindowsUpdateAccess /t REG_DWORD /d 0 /f
    reg add HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate /v ElevateNonAdmins /t REG_DWORD /d 0 /f
    reg add HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer /v NoWindowsUpdate /t REG_DWORD /d 0 /f
    reg add "HKLM\SYSTEM\Internet Communication Management\Internet Communication" /v DisableWindowsUpdateAccess /t REG_DWORD /d 0 /f
    reg add HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\WindowsUpdate /v DisableWindowsUpdateAccess /t REG_DWORD /d 0 /f





Introduction to System Hardening â€“ Windows Beginner Course
65
Network access: Sharing and security model for local
accounts
Classic - local users authenticate as themselves
Network security: Allow Local System to use computer
identify for NTLM
Enabled
Network security: Allow LocalSystem NULL session
fallback
Disabled
Network security: Allow PKU2U authentication requests
to this computer to use online identities
Disabled
Network security: Configure encryption types allowed for
Kerberos
Enable RC4HMAC_MD5, AES128_HMAC_SHA1,
AES256_HMAC_SHA1 and Future Encryption Types
Network security: Do not store LAN Manager hash value
on next password change
Enabled
Network security: Force logoff when logon hours expire Enabled
Network security: LAN Manager authentication level Sent NTLMv2 response only. Refuse LM and NTLM.
Network security: LDAP client signing requirements Negotiate signing
Network security: Minimum session security for NTLM
SSP based (including secure RPC) clients
Require NTLMv2 session security and 128-bit encryption
Network security: Minimum session security for NTLM
SSP based (including secure RPC) servers
Require NTLMv2 session security and 128-bit encryption
Network security: Restrict NTLM: Add remote servers
exceptions for NTLM authentication
Not Defined
Network security: Restrict NTLM: Add server exceptions
in this domain
Not Defined
Network security: Restrict NTLM: Audit Incoming NTLM
Traffic
Enable auditing for all accounts
Network security: Restrict NTLM: Audit NTLM
authentication in this domain
Enable all
Network security: Restrict NTLM: Incoming NTLM traffic Deny all accounts
Network security: Restrict NTLM: NTLM authentication in
this domain
Deny all
Network security: Restrict NTLM: Outgoing NTLM traffic
to remote servers

